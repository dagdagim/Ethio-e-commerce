{"ast":null,"code":"var _jsxFileName = \"C:\\\\my project\\\\final project\\\\ethio-ecommerce\\\\ethio-ecommerce-frontend\\\\src\\\\contexts\\\\CartContext.js\",\n  _s = $RefreshSig$(),\n  _s2 = $RefreshSig$();\nimport React, { createContext, useState, useContext, useEffect } from 'react';\nimport { toast } from 'react-toastify'; // ✅ Import toast\nimport 'react-toastify/dist/ReactToastify.css'; // ✅ Import CSS once in your app (or in App.jsx)\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst apiBaseUrl = (process.env.REACT_APP_API_URL || 'http://localhost:5000/api').trim();\nconst resolveAssetBaseUrl = () => {\n  const envAsset = (process.env.REACT_APP_ASSET_BASE_URL || '').trim();\n  if (envAsset) return envAsset;\n  if (apiBaseUrl) {\n    return apiBaseUrl.replace(/\\/api\\/?$/, '');\n  }\n  if (typeof window !== 'undefined') {\n    return `${window.location.protocol}//${window.location.hostname}:5000`;\n  }\n  return '';\n};\nconst assetBaseUrl = resolveAssetBaseUrl();\nconst placeholderImage = 'https://via.placeholder.com/120?text=No+Image';\nconst toAbsoluteUrl = candidate => {\n  if (!candidate) return placeholderImage;\n  const url = typeof candidate === 'string' ? candidate : candidate === null || candidate === void 0 ? void 0 : candidate.url;\n  if (!url) return placeholderImage;\n  if (/^https?:\\/\\//i.test(url)) return url;\n  const normalizedPath = url.startsWith('/') ? url : `/${url}`;\n  if (assetBaseUrl) {\n    const normalizedBase = assetBaseUrl.endsWith('/') ? assetBaseUrl.slice(0, -1) : assetBaseUrl;\n    return `${normalizedBase}${normalizedPath}`;\n  }\n  if (typeof window !== 'undefined') {\n    const origin = `${window.location.protocol}//${window.location.hostname}:5000`;\n    return `${origin}${normalizedPath}`;\n  }\n  return normalizedPath;\n};\n\n// Create context\nconst CartContext = /*#__PURE__*/createContext();\n\n// Custom hook to use CartContext\nexport const useCart = () => {\n  _s();\n  const context = useContext(CartContext);\n  if (!context) {\n    throw new Error('useCart must be used within a CartProvider');\n  }\n  return context;\n};\n\n// Provider component\n_s(useCart, \"b9L3QQ+jgeyIrH0NfHrJ8nn7VMU=\");\nexport const CartProvider = ({\n  children\n}) => {\n  _s2();\n  const [cartItems, setCartItems] = useState([]);\n  const [loading, setLoading] = useState(false);\n\n  // Load cart from localStorage on mount\n  useEffect(() => {\n    const savedCart = localStorage.getItem('ethioEcommerce_cart');\n    if (savedCart) {\n      setCartItems(JSON.parse(savedCart));\n    }\n  }, []);\n\n  // Save cart to localStorage whenever cartItems change\n  useEffect(() => {\n    localStorage.setItem('ethioEcommerce_cart', JSON.stringify(cartItems));\n  }, [cartItems]);\n\n  // ✅ Enhanced addToCart function with toast notification\n  const addToCart = (product, quantity = 1) => {\n    setCartItems(prevItems => {\n      var _product$name;\n      const existingItem = prevItems.find(item => item._id === product._id);\n      let newItems;\n      if (existingItem) {\n        newItems = prevItems.map(item => item._id === product._id ? {\n          ...item,\n          quantity: item.quantity + quantity\n        } : item);\n      } else {\n        var _product$images, _product$images$;\n        newItems = [...prevItems, {\n          _id: product._id,\n          name: product.name,\n          price: product.price,\n          image: ((_product$images = product.images) === null || _product$images === void 0 ? void 0 : (_product$images$ = _product$images[0]) === null || _product$images$ === void 0 ? void 0 : _product$images$.url) || '/images/placeholder.jpg',\n          stock: product.stock,\n          quantity: quantity\n        }];\n      }\n\n      // ✅ Show toast notification\n      toast.success(`${quantity} ${((_product$name = product.name) === null || _product$name === void 0 ? void 0 : _product$name.en) || product.name} added to cart!`, {\n        position: \"top-right\",\n        autoClose: 3000\n      });\n      return newItems;\n    });\n  };\n  const removeFromCart = productId => {\n    setCartItems(prevItems => prevItems.filter(item => item._id !== productId));\n  };\n  const updateQuantity = (productId, quantity) => {\n    if (quantity <= 0) {\n      removeFromCart(productId);\n    } else {\n      setCartItems(prevItems => prevItems.map(item => item._id === productId ? {\n        ...item,\n        quantity\n      } : item));\n    }\n  };\n  const clearCart = () => {\n    setCartItems([]);\n  };\n  const getCartTotal = () => {\n    return cartItems.reduce((total, item) => total + item.price * item.quantity, 0);\n  };\n  const getCartItemsCount = () => {\n    return cartItems.reduce((count, item) => count + item.quantity, 0);\n  };\n  const getCartSummary = () => {\n    const subtotal = getCartTotal();\n    const shipping = subtotal > 1000 ? 0 : 50; // Free shipping over 1000 ETB\n    const total = subtotal + shipping;\n    return {\n      subtotal,\n      shipping,\n      total,\n      itemsCount: getCartItemsCount()\n    };\n  };\n  const value = {\n    cartItems,\n    addToCart,\n    removeFromCart,\n    updateQuantity,\n    clearCart,\n    getCartTotal,\n    getCartItemsCount,\n    getCartSummary,\n    loading\n  };\n  return /*#__PURE__*/_jsxDEV(CartContext.Provider, {\n    value: value,\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 166,\n    columnNumber: 5\n  }, this);\n};\n_s2(CartProvider, \"m0bcaeL8tgB34JFmJbELrYeGkY0=\");\n_c = CartProvider;\nvar _c;\n$RefreshReg$(_c, \"CartProvider\");","map":{"version":3,"names":["React","createContext","useState","useContext","useEffect","toast","jsxDEV","_jsxDEV","apiBaseUrl","process","env","REACT_APP_API_URL","trim","resolveAssetBaseUrl","envAsset","REACT_APP_ASSET_BASE_URL","replace","window","location","protocol","hostname","assetBaseUrl","placeholderImage","toAbsoluteUrl","candidate","url","test","normalizedPath","startsWith","normalizedBase","endsWith","slice","origin","CartContext","useCart","_s","context","Error","CartProvider","children","_s2","cartItems","setCartItems","loading","setLoading","savedCart","localStorage","getItem","JSON","parse","setItem","stringify","addToCart","product","quantity","prevItems","_product$name","existingItem","find","item","_id","newItems","map","_product$images","_product$images$","name","price","image","images","stock","success","en","position","autoClose","removeFromCart","productId","filter","updateQuantity","clearCart","getCartTotal","reduce","total","getCartItemsCount","count","getCartSummary","subtotal","shipping","itemsCount","value","Provider","fileName","_jsxFileName","lineNumber","columnNumber","_c","$RefreshReg$"],"sources":["C:/my project/final project/ethio-ecommerce/ethio-ecommerce-frontend/src/contexts/CartContext.js"],"sourcesContent":["import React, { createContext, useState, useContext, useEffect } from 'react';\r\nimport { toast } from 'react-toastify';  // ✅ Import toast\r\nimport 'react-toastify/dist/ReactToastify.css'; // ✅ Import CSS once in your app (or in App.jsx)\r\n\r\nconst apiBaseUrl = (process.env.REACT_APP_API_URL || 'http://localhost:5000/api').trim();\r\n\r\nconst resolveAssetBaseUrl = () => {\r\n  const envAsset = (process.env.REACT_APP_ASSET_BASE_URL || '').trim();\r\n  if (envAsset) return envAsset;\r\n\r\n  if (apiBaseUrl) {\r\n    return apiBaseUrl.replace(/\\/api\\/?$/, '');\r\n  }\r\n\r\n  if (typeof window !== 'undefined') {\r\n    return `${window.location.protocol}//${window.location.hostname}:5000`;\r\n  }\r\n\r\n  return '';\r\n};\r\n\r\nconst assetBaseUrl = resolveAssetBaseUrl();\r\nconst placeholderImage = 'https://via.placeholder.com/120?text=No+Image';\r\n\r\nconst toAbsoluteUrl = (candidate) => {\r\n  if (!candidate) return placeholderImage;\r\n  const url = typeof candidate === 'string' ? candidate : candidate?.url;\r\n  if (!url) return placeholderImage;\r\n  if (/^https?:\\/\\//i.test(url)) return url;\r\n\r\n  const normalizedPath = url.startsWith('/') ? url : `/${url}`;\r\n\r\n  if (assetBaseUrl) {\r\n    const normalizedBase = assetBaseUrl.endsWith('/') ? assetBaseUrl.slice(0, -1) : assetBaseUrl;\r\n    return `${normalizedBase}${normalizedPath}`;\r\n  }\r\n\r\n  if (typeof window !== 'undefined') {\r\n    const origin = `${window.location.protocol}//${window.location.hostname}:5000`;\r\n    return `${origin}${normalizedPath}`;\r\n  }\r\n\r\n  return normalizedPath;\r\n};\r\n\r\n// Create context\r\nconst CartContext = createContext();\r\n\r\n// Custom hook to use CartContext\r\nexport const useCart = () => {\r\n  const context = useContext(CartContext);\r\n  if (!context) {\r\n    throw new Error('useCart must be used within a CartProvider');\r\n  }\r\n  return context;\r\n};\r\n\r\n// Provider component\r\nexport const CartProvider = ({ children }) => {\r\n  const [cartItems, setCartItems] = useState([]);\r\n  const [loading, setLoading] = useState(false);\r\n\r\n  // Load cart from localStorage on mount\r\n  useEffect(() => {\r\n    const savedCart = localStorage.getItem('ethioEcommerce_cart');\r\n    if (savedCart) {\r\n      setCartItems(JSON.parse(savedCart));\r\n    }\r\n  }, []);\r\n\r\n  // Save cart to localStorage whenever cartItems change\r\n  useEffect(() => {\r\n    localStorage.setItem('ethioEcommerce_cart', JSON.stringify(cartItems));\r\n  }, [cartItems]);\r\n\r\n  // ✅ Enhanced addToCart function with toast notification\r\n  const addToCart = (product, quantity = 1) => {\r\n    setCartItems(prevItems => {\r\n      const existingItem = prevItems.find(item => item._id === product._id);\r\n      let newItems;\r\n\r\n      if (existingItem) {\r\n        newItems = prevItems.map(item =>\r\n          item._id === product._id\r\n            ? { ...item, quantity: item.quantity + quantity }\r\n            : item\r\n        );\r\n      } else {\r\n        newItems = [\r\n          ...prevItems,\r\n          {\r\n            _id: product._id,\r\n            name: product.name,\r\n            price: product.price,\r\n            image: product.images?.[0]?.url || '/images/placeholder.jpg',\r\n            stock: product.stock,\r\n            quantity: quantity\r\n          }\r\n        ];\r\n      }\r\n\r\n      // ✅ Show toast notification\r\n      toast.success(`${quantity} ${product.name?.en || product.name} added to cart!`, {\r\n        position: \"top-right\",\r\n        autoClose: 3000,\r\n      });\r\n\r\n      return newItems;\r\n    });\r\n  };\r\n\r\n  const removeFromCart = (productId) => {\r\n    setCartItems(prevItems => prevItems.filter(item => item._id !== productId));\r\n  };\r\n\r\n  const updateQuantity = (productId, quantity) => {\r\n    if (quantity <= 0) {\r\n      removeFromCart(productId);\r\n    } else {\r\n      setCartItems(prevItems =>\r\n        prevItems.map(item =>\r\n          item._id === productId ? { ...item, quantity } : item\r\n        )\r\n      );\r\n    }\r\n  };\r\n\r\n  const clearCart = () => {\r\n    setCartItems([]);\r\n  };\r\n\r\n  const getCartTotal = () => {\r\n    return cartItems.reduce((total, item) => total + (item.price * item.quantity), 0);\r\n  };\r\n\r\n  const getCartItemsCount = () => {\r\n    return cartItems.reduce((count, item) => count + item.quantity, 0);\r\n  };\r\n\r\n  const getCartSummary = () => {\r\n    const subtotal = getCartTotal();\r\n    const shipping = subtotal > 1000 ? 0 : 50; // Free shipping over 1000 ETB\r\n    const total = subtotal + shipping;\r\n\r\n    return {\r\n      subtotal,\r\n      shipping,\r\n      total,\r\n      itemsCount: getCartItemsCount()\r\n    };\r\n  };\r\n\r\n  const value = {\r\n    cartItems,\r\n    addToCart,\r\n    removeFromCart,\r\n    updateQuantity,\r\n    clearCart,\r\n    getCartTotal,\r\n    getCartItemsCount,\r\n    getCartSummary,\r\n    loading\r\n  };\r\n\r\n  return (\r\n    <CartContext.Provider value={value}>\r\n      {children}\r\n    </CartContext.Provider>\r\n  );\r\n};\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}